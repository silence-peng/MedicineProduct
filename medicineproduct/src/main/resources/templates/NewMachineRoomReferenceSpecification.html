<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>新增机房参照规格</title>
    <link rel="stylesheet" href="lib/layui-v2.5.5/css/layui.css" media="all">
    <link rel="stylesheet" href="css/layuimini.css?v=2.0.4" media="all">
    <link rel="stylesheet" href="css/themes/default.css" media="all">
    <link rel="stylesheet" href="lib/font-awesome-4.7.0/css/font-awesome.min.css" media="all">

    <script src="lib/layui-v2.5.5/layui.js" charset="utf-8"></script>
    <script src="js/lay-config.js?v=2.0.0" charset="utf-8"></script>
    <!-- 重要js -->
    <script src="lib/jquery-3.4.1/jquery-3.4.1.min.js" charset="UTF-8"></script>
</head>
<style type="text/css">
    .btn-bgcolor {
        background-color: #286ED6;
        width: 80px;
    }

    .btn-bgcolor1 {
        background-color: #286ED6;

    }

    .btn-bgcolor2 {
        background-color: #ff1c1f;
        width: 80px;
    }

    .btn-bgcolor4 {
        background-color: #00cc00;
        width: 80px;
    }

    .btn-bgcolor3 {

        width: 80px;
    }
</style>
<body>
<form class="layui-form">
    <div class="layui-form-item">
        <div class="layui-inline">
        </div>
        <div class="layui-inline">
        </div>
    </div>

    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">上传文档</label>
            <div class="layui-input-inline">
                <div class="layui-upload">
                    <button type="button" class="layui-btn layui-btn-normal  btn-bgcolor1" id="SelectFile">选择文件</button>
                </div>
            </div>
        </div>
        <div class="layui-inline">
            <label class="layui-form-label">文档名</label>
            <div class="layui-input-inline">
                <input class="layui-input" type="text" autocomplete="off" id="filename"
                       name="filename" disabled="disabled"/>
            </div>
        </div>
    </div>


    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">氧气最大输出功率</label>
            <div class="layui-input-inline">
                <input class="layui-input" type="text" autocomplete="off" id="oxygenMaxOutputPower"
                       name="oxygenMaxOutputPower"/>
            </div>
        </div>
        <div class="layui-inline">
            <label class="layui-form-label">氧气最小输出功率</label>
            <div class="layui-input-inline">
                <input class="layui-input" type="text" autocomplete="off" id="oxygenMinOutputPower"
                       name="oxygenMinOutputPower"/>
            </div>
        </div>
    </div>
    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">真空最大输出功率</label>
            <div class="layui-input-inline">
                <input class="layui-input" type="text" autocomplete="off" id="vacuumMaxOutputPower"
                       name="vacuumMaxOutputPower"/>
            </div>
        </div>
        <div class="layui-inline">
            <label class="layui-form-label">真空最小输出功率</label>
            <div class="layui-input-inline">
                <input class="layui-input" type="text" autocomplete="off" id="vacuumMinOutputPower"
                       name="vacuumMinOutputPower"/>
            </div>
        </div>
    </div>
    <div class="layui-form-item">
        <div class="layui-inline">
            <label class="layui-form-label">空气最大输出功率</label>
            <div class="layui-input-inline">
                <input class="layui-input" type="text" autocomplete="off" id="airMaxOutputPower"
                       name="airMaxOutputPower"/>
            </div>
        </div>
        <div class="layui-inline">
            <label class="layui-form-label">空气最小输出功率</label>
            <div class="layui-input-inline">
                <input class="layui-input" type="text" autocomplete="off" id="airMinOutputPower"
                       name="airMinOutputPower"/>
            </div>
        </div>
    </div>
    <div class="layui-form-item" style="text-align: center;">
        <div class="layui-inline">
            <div class="layui-form-item">
                <input type="button" class="layui-btn btn-bgcolor" value="确定" id="but_yes">
            </div>
        </div>
    </div>

</form>

</body>
<script>
    var reg = new RegExp("^[0-9]*$");

    layui.use(['element', 'form', 'jquery', 'table', 'laydate', 'upload'], function () {
        var $ = layui.jquery,
            element = layui.element,
            layer = layui.layer,
            form = layui.form,
            table = layui.table,
            laydate = layui.laydate;
        upload = layui.upload;

        //日期选择器
        laydate.render({
            elem: '#DateOfBirth'
            //,type: 'date' //默认，可不填
        });


        $("#but_yes").on("click", function () {
            if ($("#filename").val() == "") {
                layer.msg("请上传文件!");
                return false;
            } else {

                if ($("#oxygenMaxOutputPower").val() == "") {
                    layer.msg("氧气最大输出功率不能为空")
                    return false;
                } else {
                    if (!reg.test($("#oxygenMaxOutputPower").val())) {
                        layer.msg("请输入数字！");
                        return false;
                    }
                }
                if ($("#oxygenMinOutputPower").val() == "") {
                    layer.msg("氧气最小输出功率不能为空")
                    return false;
                } else {
                    if (!reg.test($("#oxygenMinOutputPower").val())) {
                        layer.msg("请输入数字！");
                        return false;
                    }
                }


                if ($("#vacuumMaxOutputPower").val() == "") {
                    layer.msg("真空最大输出功率不能为空")
                    return false;
                } else {
                    if (!reg.test($("#vacuumMaxOutputPower").val())) {
                        layer.msg("请输入数字！");
                        return false;
                    }
                }
                if ($("#vacuumMinOutputPower").val() == "") {
                    layer.msg("真空最小输出功率不能为空")
                    return false;
                } else {
                    if (!reg.test($("#vacuumMinOutputPower").val())) {
                        layer.msg("请输入数字！");
                        return false;
                    }
                }


                if ($("#airMaxOutputPower").val() == "") {
                    layer.msg("空气最大输出功率不能为空")
                    return false;
                } else {
                    if (!reg.test($("#airMaxOutputPower").val())) {
                        layer.msg("请输入数字！");
                        return false;
                    }
                }
                if ($("#airMinOutputPower").val() == "") {
                    layer.msg("空气最小输出功率不能为空")
                    return false;
                } else {
                    if (!reg.test($("#airMinOutputPower").val())) {
                        layer.msg("请输入数字！");
                        return false;
                    }
                }

                $.ajax({
                    url: "/AddMachineRoom",
                    data: {
                            "fileName":$("#filename").val(),

                            "oxygenMaxOutputPower":$("#oxygenMaxOutputPower").val(),
                            "oxygenMinOutputPower":$("#oxygenMinOutputPower").val(),

                            "vacuumMaxOutputPower":$("#vacuumMaxOutputPower").val(),
                            "vacuumMinOutputPower":$("#vacuumMinOutputPower").val(),

                            "airMaxOutputPower":$("#airMaxOutputPower").val(),
                            "airMinOutputPower":$("#airMinOutputPower").val()

                            },
                    type: "post",
                    dataType: "text",
                    success: function (result) {
                        if (result == "yes") {
                            layer.msg("档案添加成功", function () {
                                var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
                                parent.layer.close(index); //再执行关闭
                            })
                        } else {
                            layer.alert("档案添加失败");
                        }
                    }
                })
            }

        });


        //选完文件后不自动上传
        upload.render({
            elem: '#SelectFile',
            url: 'UpdateMachineRoomFlie', //改成您自己的上传接口
            auto: true,
            accept: 'file' //普通文件
            , size: 100 * 1024
            ,
            exts: 'docx|xlsx|xls' //只允许指定文件
            //,multiple: tru
            ,
            done: function (res) {
                layer.msg('上传成功');
                $("#filename").val(res.data);
                console.log(res);
            },
            erroe: function (res) {
                layer.msg("上传失败")
            }
        });

    });
</script>
</html>
